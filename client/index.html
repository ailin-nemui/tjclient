<html>
  <head>
    <title>Test Client</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/jquery-ui.min.js"></script>
    <script src="lib/irc.js"></script>
    <link rel="stylesheet" type="text/css" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/smoothness/jquery-ui.css" />
    <style>
      .container {
        overflow: auto;
        height: 550px;
      }
    </style>
    <script type="text/javascript">
    $(function() {
      $('#content').tabs()
    })

    function append_message(tab, msg) {
      $('#'+tab).append(msg+'<br/>')
      var d = $('#'+tab)[0]
      d.scrollTop = d.scrollHeight;
    }

    function server_log(msg) {
      append_message('server', msg)
    }

    function server_message(source, target, msg) {
      append_message('server', msg)
    }

    $(function() {
      $('#connect').click(function() {
        var servername = $('#servername').eq(0).val()
        var port = $('#port').eq(0).val()
        $('#connect')[0].disabled = true;

        var ws = new WebSocket("ws://"+servername+":"+port)

        ws.onopen = function() {
          server_log('Connected')
        }

        ws.onmessage = function(msg) {
          server_log(msg.data);
        }

        ws.onerror = function() {
          server_log(arguments)
        }

        ws.onclose = function() {
          server_log('Closed')
          $('#connect')[0].disabled = false;
        }

      })

      $('#command').keyup(function(e) {
        if(e.keyCode == 13) {
          if(ircConn) {
            ircConn.sendMessage($('#command').eq(0).val())
            $('#command').eq(0).val('')
          }
        }
      })
    });
    </script>
  <head>
  <body>
    Server: <input type="textbox" id="servername" value="localhost" />
    Port: <input type="textbox" id="port" value="3000" />
    <input type="button" value="connect" id="connect" />
    <div id="content">
      <ul>
        <li><a href="#server">Server</a></li>
      </ul>
      <div id="server" class="container"></div>
    </div>
    <br/>
    Command: <input type="textbox" id="command" size="100%" maxlength="510" />
  </body>
</html>
